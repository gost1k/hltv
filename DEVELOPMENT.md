# История разработки HLTV Parser

Этот документ содержит историю разработки, принятые решения и текущее состояние проекта для облегчения продолжения работы в будущем.

## Текущее состояние проекта

HLTV Parser представляет собой инструмент для сбора и анализа информации о матчах CS:GO с сайта HLTV.org.

### Архитектура проекта

- **Сбор данных**: Парсеры для страниц предстоящих матчей, результатов и деталей матчей
- **Хранение данных**: SQLite база данных с таблицами `url_upcoming` и `url_result`
- **Утилиты**: Скрипты для миграции и обновления данных

### База данных

Текущая структура базы данных:

- `url_upcoming` - таблица предстоящих матчей (id, url, date, toParse)
- `url_result` - таблица прошедших матчей (id, url, toParse)

## История изменений

### Май 2025: Реструктуризация базы данных

1. Изменена структура базы данных:

   - Старые таблицы: `upcoming_matches` и `past_matches`
   - Новые таблицы: `url_upcoming` и `url_result`
   - Удалены устаревшие таблицы: `matches` и `results`

2. Создан скрипт миграции данных `src/check/migrate_db.py`

3. Добавлен скрипт `src/check/update_parsed_matches.py` для обновления статуса проанализированных матчей

### Апрель 2025: Улучшения функциональности

1. Добавлен параметр `--test` для запуска парсера деталей матчей в тестовом режиме (обработка только 3 матчей)

2. Изменен формат имен файлов:

   - Старый формат: `match_ID.html`
   - Новый формат: `match_ID-КОМАНДА1-vs-КОМАНДА2-ТУРНИР.html`

3. Изменена структура базы данных:

   - Созданы две отдельные таблицы: `upcoming_matches` (предстоящие матчи) и `past_matches` (прошедшие матчи)
   - Обеспечен автоматический перенос матчей между таблицами

4. Добавлены параметры командной строки:

   - `--parse-past` - парсить прошедшие матчи
   - `--parse-upcoming` - парсить предстоящие матчи

5. Создан скрипт для переименования существующих файлов в новый формат

6. Исправлена проблема двойного запуска скрипта

7. Добавлено более подробное логирование операций

## Текущие задачи и проблемы

1. Обработано 21 из 100 матчей в таблице `url_result`

## Планы на будущее

1. Добавить поддержку многопоточности для параллельного парсинга матчей
2. Реализовать API для доступа к данным
3. Улучшить обработку ошибок и восстановление после сбоев
4. Добавить модуль анализа собранных данных

## Используемые технологии

- Python 3.8+
- SQLite для хранения данных
- Selenium для парсинга динамического контента
- Beautiful Soup для парсинга HTML

## Запуск проекта

См. [README.md](README.md) для инструкций по запуску проекта.
