# Telegram-бот для статистики матчей HLTV

Этот телеграм-бот предоставляет информацию о прошедших матчах CS2 с сайта HLTV. Бот группирует матчи по турнирам и отображает результаты с выделением победителей.

## Функции бота

- Просмотр результатов матчей за различные периоды:
  - За вчерашний день
  - За 3 дня
  - За неделю
- Просмотр актуальной статистики матчей
- Подписка на ежедневную рассылку результатов матчей
- Удобное меню с кнопками

## Команды бота

- `/start` - Начало работы с ботом
- `/help` - Справка по командам
- `/menu` - Отображение главного меню
- `/yesterday` - Показать результаты за вчерашний день
- `/today` - Показать результаты за сегодняшний день
- `/subscribe` - Подписаться на ежедневную рассылку
- `/unsubscribe` - Отписаться от ежедневной рассылки

## Настройка и запуск

### Требования

- Python 3.6+
- pip
- База данных HLTV (собранная с помощью коллектора)

### Установка зависимостей

```bash
pip install python-telegram-bot
```

### Конфигурация

Бот использует конфигурационный файл `config/bots/user_bot_config.json`, который будет создан автоматически при первом запуске. Необходимо отредактировать его и внести следующие параметры:

```json
{
  "token": "YOUR_BOT_TOKEN_HERE", // Токен бота, полученный от BotFather
  "hltv_db_path": "hltv.db", // Путь к файлу SQLite базы данных с матчами
  "subscribers_db_path": "subscribers.db", // Путь к файлу SQLite базы данных для хранения подписчиков
  "log_file": "user_bot.log", // Путь к файлу логов
  "daily_report_time": "09:00", // Время отправки ежедневного отчета
  "admin_chat_ids": [] // ID чатов администраторов для уведомлений
}
```

### Запуск бота

```bash
# Запустите бота
python start_user_bot.py
```

### Настройка ежедневной рассылки

Для запуска ежедневной рассылки результатов матчей используйте скрипт `send_daily_report.py`. Его можно добавить в планировщик задач:

**Linux/Mac (cron)**:

```bash
# Добавьте в crontab строку для запуска каждый день в 9:00 утра
0 9 * * * cd /path/to/hltv-2 && python send_daily_report.py
```

**Windows (Task Scheduler)**:

1. Создайте batch-файл `send_report.bat`:

```batch
@echo off
cd C:\path\to\hltv-2
python send_daily_report.py
```

2. Добавьте этот файл в планировщик задач Windows с ежедневным запуском.

## Структура проекта

- `start_user_bot.py` - точка входа для запуска бота пользователей
- `send_daily_report.py` - скрипт для отправки ежедневных отчетов
- `src/bots/user_bot/telegram_bot.py` - основной класс телеграм-бота для пользователей
- `src/bots/user_bot/daily_report.py` - класс для отправки ежедневных отчетов
- `src/config/bot_config.py` - модуль для работы с конфигурацией ботов
- `config/bots/user_bot_config.json` - файл конфигурации бота для пользователей
- `subscribers.db` - база данных SQLite с подписчиками бота

## Примечания

- Бот требует доступа к базе данных с результатами матчей, собранными с помощью коллектора HLTV
- Для полноценной работы бота необходимо, чтобы коллектор регулярно обновлял данные о матчах
- Бот выделяет в сообщениях названия команд-победителей жирным шрифтом
- Группировка матчей происходит по турнирам, в которых они проводились
- При первом запуске будет создан файл конфигурации с настройками по умолчанию, который нужно отредактировать
